path(path, 'maths');
path(path, 'utils');
path(path, 'collisions');
path(path, 'algorithm');

% [min_x max_x min_t max_t]
TEST_OBSTACLES = [
    
    %1.75 3.25 1.75 3.25;
    
    %5    7.5    6   100;
    %12   14    9  16.5
    %8   12  5   7;
    %16  22  6   8;
    %12  17  0.1 1;
    %3   5   4   10;
    %3   7   0   3;
    
    %8   10  3   7;
    
    %2 3 1 3;
    %5 6 6 24;
    %8 9 0 6;
    %11 12 8 24
    
    % FINAL
    %23 23.5 18 20;  
    %23 23.5 8 14.5
    
    %23 23.5 12.5 19
    
    %21 22 5 10;
    %23 23.5 12.5 13;
    %22 23 16 16.5    
    
    %12 30 12 14
    
    
    % INITIAL
    %2 3 5.5 6.5
    
    %1 1.5 4.5 5;
    %2.5 3 7 7.5
    
    %1 8.5 4.5 5.5
    
    % INNER
    %10   13  8.8   17
    
    %13   15  5.5   9
    
    %13.5 13.75 8.95 9.05;
    %13.25 13.5 8.8 8.85
    
    %13.7 13.75 9.15 9.2;
    %13.25 13.3 8.75 8.8
    
    % Yajia
    %11.739220215680525	20.087625918456343 -0.17422258912517313	0.6090218694172226;
    %11.739220215680525	20.087625918456343 1.3257774108748268	2.1090218694172225;
    %7.6122993580436455	16.740231640500724 2.973970284437974	3.9090001100806178;
    %1.9803114754246924	13.059238667311725 2.4272905889403704	3.7125361550846057;
    %1.9803114754246924	13.059238667311725 3.9272905889403704	5.212536155084606
    
    % Yajia 2
    %11.739220215680525	20.087625918456343 -0.17422258912517313	0.6090218694172226
    %11.739220215680525	20.087625918456343 1.3257774108748268	2.1090218694172225
    %7.6122993580436455	16.740231640500724 4.973970284437974	5.909000110080617
    %1.9803114754246924	13.059238667311725 4.42729058894037	5.712536155084606
    %1.9803114754246924	13.059238667311725 5.92729058894037	7.2125361550846065
    
    % Yajia 3
    %1.5 11.5 2.1953 4.7778;
    %6.3 15.5 2.7635 4.8025;
    %10.6 19.3 2.2955 4.0916
    
    % Yajia 4
    %10.6 19.3 1.3955 2.8916
    
    % Yajia 5
    %1.5 11.5 1.2953 3.5778;
    %6.3 15.5 1.8635 3.6025;
    %10.6 19.3 1.3955 2.8916
    
    % Yajia 6
    %1.5 11.5 1.2953 3.5778;
    %6.3 15.5 3.8635 5.6025;
    %10.6 19.3 5.3955 6.8916
    
    % Yajia 7
    %1.5 11.5 3.4953 5.7778;
    %1.5 11.5 2.4953 4.7778;
    %18.8 27.3 2.7 4.0;
    %18.8 27.3 1.3 2.6
    
    % Prune test
    %6   13  10   20;
    %8   12  1   9;
    %15  20  11  20;
    %13  15  2   9.5
    
    % Test sort
    %1 2 4 5;
    %3 4 4 5;
    %4.5 5.5 4.5 5.5;
    %4.5 5.5 1 2
    
    % Paper fig
    %1.5 11.5 2.3 3.5;
    %18.8 27.3 2.4953 4.7778
    
    % Disjoint intervals
    %0.125   3.9   1.5   2.5;
    %4.09     5   1.5   3.9081
    
    
    % Crazy scenario

1.5 11.5 10.7382 16.4445;
1.5 11.5 22.7382 28.4445;
1.5 11.5 34.7382 40.4445;
1.5 11.5 46.7382 52.4445;
1.5 11.5 58.7382 64.4445;
1.5 11.5 70.7382 76.4445;
6.3 15.5 4.1058 7.0041;
6.3 15.5 12.1058 15.0041;
6.3 15.5 20.1058 23.0041;
6.3 15.5 28.1058 31.0041;
6.3 15.5 36.1058 39.0041;
6.3 15.5 44.1058 47.0041;
10.6 19.3 7.991 10.9832;
10.6 19.3 17.591 20.5832;
10.6 19.3 27.191 30.1832;
10.6 19.3 36.791 39.7832;
10.6 19.3 46.391 49.3832;
10.6 19.3 55.991 58.9832;
14.7 23.3 1.0998 2.7501;
14.7 23.3 7.0998 8.7501;
14.7 23.3 13.0998 14.7501;
14.7 23.3 19.0998 20.7501;
14.7 23.3 25.0998 26.7501;
14.7 23.3 31.0998 32.7501;
18.8 27.3 3.5714 5.4286;
18.8 27.3 10.4286 12.2857;
18.8 27.3 17.2857 19.1429;
18.8 27.3 24.1429 26.0;
18.8 27.3 31.0 32.8571;
18.8 27.3 37.8571 39.7143;
22.8 31.3 7.4545 9.8182;
22.8 31.3 16.1818 18.5455;
22.8 31.3 24.9091 27.2727;
22.8 31.3 33.6364 36.0;
22.8 31.3 42.3636 44.7273;
22.8 31.3 51.0909 53.4545;
26.8 35.3 16.2857 20.0;
26.8 35.3 30.0 33.7143;
26.8 35.3 43.7143 47.4286;
26.8 35.3 57.4286 61.1429;
26.8 35.3 71.1429 74.8571;
26.8 35.3 84.8571 88.5714;
30.8 39.3 3.3333 5.0667;
30.8 39.3 9.7333 11.4667;
30.8 39.3 16.1333 17.8667;
30.8 39.3 22.5333 24.2667;
30.8 39.3 28.9333 30.6667;
30.8 39.3 35.3333 37.0667;
34.8 43.3 3.5714 5.4286;
34.8 43.3 10.4286 12.2857;
34.8 43.3 17.2857 19.1429;
34.8 43.3 24.1429 26.0;
34.8 43.3 31.0 32.8571;
34.8 43.3 37.8571 39.7143;
38.8 47.3 4.1667 6.3333;
38.8 47.3 12.1667 14.3333;
38.8 47.3 20.1667 22.3333;
38.8 47.3 28.1667 30.3333;
38.8 47.3 36.1667 38.3333;
38.8 47.3 44.1667 46.3333;
42.8 51.3 1.125 2.75;
42.8 51.3 7.125 8.75;
42.8 51.3 13.125 14.75;
42.8 51.3 19.125 20.75;
42.8 51.3 25.125 26.75;
42.8 51.3 31.125 32.75;
46.8 55.3 8.2 10.8;
46.8 55.3 17.8 20.4;
46.8 55.3 27.4 30.0;
46.8 55.3 37.0 39.6;
46.8 55.3 46.6 49.2;
46.8 55.3 56.2 58.8;
50.8 59.3 4.1667 6.3333;
50.8 59.3 12.1667 14.3333;
50.8 59.3 20.1667 22.3333;
50.8 59.3 28.1667 30.3333;
50.8 59.3 36.1667 38.3333;
50.8 59.3 44.1667 46.3333
%}
    
    % Colision test
    %26.5 36 6.051282051282051099860837 6.923076923076923350208745;
    %26.5 36 6.051282051282051099860837 6.923076923076923350208745;
    
    
    % Crazy scenario 2
    %{
    2.5 12.0 15.45 16.3;
2.5 12.0 13.05 13.9;
2.5 12.0 9.65 10.5;
2.5 12.0 7.25 8.1;
2.5 12.0 2.65 3.5;
2.5 12.0 0.95 1.8;
10.5 20.0 0.2222222222222222 0.8518518518518519;
10.5 20.0 2.0 2.6296296296296298;
10.5 20.0 3.7777777777777777 4.407407407407407;
10.5 20.0 5.555555555555555 6.185185185185185;
10.5 20.0 7.333333333333333 7.962962962962963;
10.5 20.0 9.11111111111111 9.74074074074074;
18.5 28.0 1.3529411764705883 2.3529411764705883;
18.5 28.0 7.823529411764706 8.823529411764707;
18.5 28.0 9.470588235294118 10.470588235294118;
18.5 28.0 12.294117647058824 13.294117647058824;
18.5 28.0 14.882352941176471 15.882352941176471;
18.5 28.0 17.235294117647058 18.235294117647058;
26.5 36.0 1.1282051282051282 2.0;
26.5 36.0 3.58974358974359 4.461538461538462;
26.5 36.0 6.051282051282051 6.923076923076923;
26.5 36.0 8.512820512820513 9.384615384615385;
26.5 36.0 10.974358974358974 11.846153846153847;
26.5 36.0 13.435897435897436 14.307692307692308;
34.5 44.0 2.2 3.3333333333333335;
34.5 44.0 8.066666666666666 9.2;
34.5 44.0 11.266666666666667 12.4;
34.5 44.0 15.266666666666667 16.4;
34.5 44.0 17.666666666666668 18.8;
34.5 44.0 20.866666666666667 22.0;
42.5 52.0 1.2222222222222223 2.1666666666666665;
42.5 52.0 3.888888888888889 4.833333333333333;
42.5 52.0 6.555555555555555 7.5;
42.5 52.0 9.222222222222221 10.166666666666666;
42.5 52.0 11.88888888888889 12.833333333333334;
50.5 60.0 1.1 1.6666666666666667;
50.5 60.0 4.033333333333333 4.6;
50.5 60.0 5.633333333333334 6.2;
50.5 60.0 6.433333333333334 7.0;
50.5 60.0 8.1 8.666666666666666;
50.5 60.0 9.433333333333334 10.0
%}
    
    % ICRA scenario
    %{
2.5, 12.0, 15.45, 16.3;
2.5, 12.0, 11.05, 11.9;
2.5, 12.0, 7.65, 8.5;
2.5, 12.0, 5.25, 6.1;
2.5, 12.0, 2.65, 3.5;
2.5, 12.0, 0.95, 1.8;
10.5, 20.0, 0.0, 0.11538461538461539;
10.5, 20.0, 2.076923076923077, 2.730769230769231;
10.5, 20.0, 4.6923076923076925, 5.346153846153846;
10.5, 20.0, 6.538461538461538, 7.1923076923076925;
10.5, 20.0, 9.153846153846153, 9.807692307692308;
10.5, 20.0, 11.0, 11.653846153846153;
18.5, 28.0, 1.434782608695652, 2.1739130434782608;
18.5, 28.0, 5.782608695652174, 6.521739130434782;
18.5, 28.0, 7.869565217391305, 8.608695652173912;
18.5, 28.0, 9.956521739130435, 10.695652173913043;
18.5, 28.0, 11.0, 11.73913043478261;
18.5, 28.0, 12.73913043478261, 13.478260869565217;
26.5, 36.0, 1.1282051282051282, 2.0;
26.5, 36.0, 3.58974358974359, 4.461538461538462;
26.5, 36.0, 6.051282051282051, 6.923076923076923;
26.5, 36.0, 8.512820512820513, 9.384615384615385;
26.5, 36.0, 10.974358974358974, 11.846153846153847;
26.5, 36.0, 13.435897435897436, 14.307692307692308;
34.5, 44.0, 1.5714285714285714, 2.380952380952381;
34.5, 44.0, 4.809523809523809, 5.619047619047619;
34.5, 44.0, 8.047619047619047, 8.857142857142858;
34.5, 44.0, 10.904761904761905, 11.714285714285714;
34.5, 44.0, 12.619047619047619, 13.428571428571429;
34.5, 44.0, 14.904761904761905, 15.714285714285714;
42.5, 52.0, 0.0, 0.0;
42.5, 52.0, 0.9166666666666666, 1.625;
42.5, 52.0, 2.9166666666666665, 3.625;
42.5, 52.0, 4.916666666666667, 5.625;
42.5, 52.0, 6.916666666666667, 7.625;
42.5, 52.0, 8.916666666666666, 9.625;
50.5, 60.0, 1.65, 2.5;
50.5, 60.0, 5.05, 5.9;
50.5, 60.0, 8.45, 9.3;
50.5, 60.0, 9.65, 10.5;
50.5, 60.0, 12.15, 13.0;
50.5, 60.0, 13.65, 14.5;
    %}
    
    % 2 Lanes
    %{
    14.5, 24.0, 0.5384615384615384, 1.1923076923076925;
14.5, 24.0, 1.4615384615384615, 2.115384615384616;
14.5, 24.0, 3.3076923076923075, 3.9615384615384617;
14.5, 24.0, 3.4615384615384617, 4.115384615384615;
14.5, 24.0, 6.230769230769231, 6.884615384615385;
14.5, 24.0, 7.538461538461538, 8.192307692307692;
26.5, 36.0, 2.1025641025641026, 2.9743589743589745;
26.5, 36.0, 3.0256410256410255, 3.8974358974358974;
26.5, 36.0, 5.897435897435898, 6.769230769230769;
26.5, 36.0, 8.666666666666666, 9.538461538461538;
26.5, 36.0, 11.128205128205128, 12.0;
26.5, 36.0, 12.564102564102564, 13.435897435897436
    %}
    
    % 3 Lanes
    %{
    10.5, 20.0, 9.3, 10.15;
10.5, 20.0, 4.9, 5.75;
10.5, 20.0, 1.5, 2.35;
10.5, 20.0, 0.0, 0.0;
10.5, 20.0, 0.0, 0.0;
10.5, 20.0, 0.0, 0.0;
14.5, 24.0, 0.0, 0.11538461538461565;
14.5, 24.0, 1.6153846153846154, 2.2692307692307696;
14.5, 24.0, 4.6923076923076925, 5.346153846153846;
14.5, 24.0, 6.538461538461538, 7.1923076923076925;
14.5, 24.0, 8.538461538461538, 9.192307692307692;
14.5, 24.0, 11.0, 11.653846153846153;
18.5, 28.0, 0.0, 0.0;
18.5, 28.0, 0.43478260869565216, 1.173913043478261;
18.5, 28.0, 2.5217391304347827, 3.260869565217391;
18.5, 28.0, 4.608695652173913, 5.3478260869565215;
18.5, 28.0, 5.6521739130434785, 6.391304347826087;
18.5, 28.0, 7.391304347826087, 8.130434782608695;
26.5, 36.0, 7.435897435897436, 8.307692307692308;
26.5, 36.0, 9.897435897435898, 10.76923076923077;
26.5, 36.0, 12.35897435897436, 13.23076923076923;
26.5, 36.0, 14.820512820512821, 15.692307692307692;
26.5, 36.0, 17.28205128205128, 18.153846153846153;
26.5, 36.0, 19.743589743589745, 20.615384615384617;
30.5, 40.0, 1.5714285714285714, 2.380952380952381;
30.5, 40.0, 4.809523809523809, 5.619047619047619;
30.5, 40.0, 7.285714285714286, 8.095238095238095;
30.5, 40.0, 10.904761904761905, 11.714285714285714;
30.5, 40.0, 12.619047619047619, 13.428571428571429;
30.5, 40.0, 14.904761904761905, 15.714285714285714;
34.5, 44.0, 4.041666666666667, 4.75;
34.5, 44.0, 6.041666666666667, 6.75;
34.5, 44.0, 8.041666666666666, 8.75;
34.5, 44.0, 10.041666666666666, 10.75;
34.5, 44.0, 12.041666666666666, 12.75;
34.5, 44.0, 14.041666666666666, 14.75;
    %}
    
    % Backwards
    %{
38.5 48 -7.63333333333333463599501556018 -6.78333333333333321490954403998;
38.5 48 -5.23333333333333428072364768013 -4.38333333333333463599501556018;
38.5 48 -1.83333333333333392545227980008 -0.983333333333334280723647680134;
38.5 48 0.566666666666666429819088079967 1.41666666666666607454772019992;
38.5 48 5.16666666666666607454772019992 6.01666666666666571927635231987;
38.5 48 6.86666666666666625218340413994 7.71666666666666589691203625989;
30.5 40 7.81481481481481399242738916655 8.44444444444444464181742660003;
30.5 40 6.03703703703703631333610246656 6.66666666666666607454772019992;
30.5 40 4.25925925925925863424481576658 4.88888888888888839545643349993;
30.5 40 2.48148148148148095515352906659 3.11111111111111071636514679994;
30.5 40 0.703703703703703276062242366606 1.33333333333333303727386009996;
30.5 40 -1.07407407407407440302904433338 -0.444444444444444641817426600028;
22.5 32 6.31372549019607731679570861161 7.31372549019607731679570861161;
22.5 32 -0.156862745098040434754693706054 0.843137254901960453423725994071;
22.5 32 -1.80392156862745167700268211775 -0.803921568627451677002682117745;
22.5 32 -4.62745098039215818630509602372 -3.62745098039215818630509602372;
22.5 32 -7.21568627450980493165388907073 -6.21568627450980493165388907073;
22.5 32 -9.56862745098039191304906125879 -8.56862745098039191304906125879;
14.5 24 6.66666666666666607454772019992 7.53846153846153832489562773844;
14.5 24 4.20512820512820439944334793836 5.07692307692307664979125547688;
14.5 24 1.7435897435897427243389756768 2.61538461538461497468688321533;
14.5 24 -0.717948717948718950765396584757 0.153846153846153299582510953769;
14.5 24 -3.17948717948718062586976884631 -2.30769230769230837552186130779;
14.5 24 -5.64102564102564230097414110787 -4.76923076923077005062623356935;
6.5 16 5.33333333333333214909544039983 6.46666666666666589691203625989;
6.5 16 -0.533333333333333214909544039983 0.59999999999999964472863211995;
6.5 16 -3.73333333333333428072364768013 -2.6000000000000014210854715202;
6.5 16 -7.73333333333333250436680827988 -6.6000000000000014210854715202;
6.5 16 -10.1333333333333346359950155602 -9.00000000000000177635683940025;
6.5 16 -13.3333333333333339254522798001 -12.2000000000000010658141036402;
-1.5 8 6.5 7.4444444444444437536390068999;
-1.5 8 3.83333333333333303727386009996 4.77777777777777679091286699986;
-1.5 8 1.16666666666666607454772019992 2.11111111111111071636514679994;
-1.5 8 -1.5 -0.555555555555555358182573399972;
-1.5 8 -4.16666666666666785090455960017 -3.22222222222222320908713300014;
-9.5 -0 6.99999999999999911182158029987 7.56666666666666642981908807997;
-9.5 -0 4.06666666666666642981908807997 4.63333333333333285963817615993;
-9.5 -0 2.46666666666666589691203625989 3.03333333333333232673112433986;
-9.5 -0 1.66666666666666607454772019992 2.23333333333333250436680827988;
-9.5 -0 -0 0.566666666666666429819088079967;
-9.5 -0 -1.33333333333333392545227980008 -0.766666666666667495633191720117;
50.5 65 -1 8.66666666666666607454772019992
%}
    % C++ test
    
    %1 2 1 2;
    %3 4 3 4;
    %5 6 4 5;
    %7 8 7 8
    %}
    
    % Java test 1
    %8.8 17.5 0.0455111 1.54159
    
    % Java test 2
    %5.6 14.3 0.0455111 1.54159
    
    % Java test 3
    %10.4875 19.1875 0.0455111 1.54159
    
    % Java test 4
    %8.800000000000000710542736, 17.5, 0.7455111311170740107101551, 2.241586890870244541673628
    
    % Java test 5
    %10.17500000000000071054274 18.875 -0.004488868882926100312147355 1.491586890870244319629023
    
    % Java test 6
    %7.150000000000001243449788, 15.85000000000000142108547, -0.5544888688829261447210683, 0.9415868908702442752201023
    
    % Java test 7
    %7.150000000000001243449788, 15.85000000000000142108547, -0.1044888688829259670853844, 1.391586890870244452855786
    
    % Java test 8
    %8.714999999999998081534613 16.59999999999999786837179 0 34.57076380574687135549539;
    %21.99499999999999744204615 29.87999999999999545252649 0 37.49126180030111044061414;
    %35.27499999999999147348717 43.15999999999998948396751 0 49.7999999999999900524017 
    
    % Java test 9
    %-10.68500000000001293187779 -2.185000000000007602807273 -3.149999999999986144416653 -1.449999999999994404475956
    
    %5 6 3 5
    ];


s_O = size(TEST_OBSTACLES);
if s_O(1, 1)>0
    O_sorted = sortObstacles(TEST_OBSTACLES, 'max_x');
    o_max_x = O_sorted(end, :);
    p_max_x = getObstacleCorner(o_max_x, 'lower-right');
    max_x = getStateCoord(p_max_x, 'x');
else
    max_x = 20;
end

max_x = 10;

% [ttc e_left e_right e_bottom e_top acc_min acc_max vel_min vel_max x_limit t_limit numeric_accuracy]

% Disjoint intervals
%TEST_MARGINS = [.01 .01 .01 .01 .01 -4 4 0 10 5.5 4.5 0.00000000015];

% Stress testing
%TEST_MARGINS = [.01 .01 .01 .01 .01 -4 4 0 10 200 200 0.0001];

% Simulator
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 67.3403568041163 50 0.000001];

% Testing
%TEST_MARGINS = [.01 .01 .01 .01 .01 -4 4 0 10 67.3403568041163 50 0.0000000001];
%TEST_MARGINS = [.01 .01 .01 .01 .01 -5 7 0 10 67.3403568041163 50 0.0000000001];

% Java test 1
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 65.5404 48.65 0.0000000001];

% Java test 2
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 62.3404 48.65 0.0000000001];

% Java test 3
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 67.2279 48.65 0.0000000001];

% Java test 4
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 65.54035680411629982700106 49.35000000000000142108547 0.0000000001];

% Java test 5
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 66.91535680411629982700106 48.60000000000000142108547 0.0000000001];

% Java test 6
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 63.89035680411629414265917 48.04999999999999715782906 0.0000000001];

% Java test 7
%TEST_MARGINS = [.01 .01 .01 .01 .01 -8 10 0 10 65 30 0.00000000015];

%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 64 20 0.00000000015];
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 6.5 3.5 0.00000000015];

% Java test 8
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 24 64 51.85000000000002273736754 0.00000000015];

% Java test 9
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 50 64.315000000000001278976924 51.250000000000049737991503 0.00000000015];
%TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 15 63.3699999999996350652509136125 100 0.00000000015];
TEST_MARGINS = [.01 .01 .01 .01 .01 -10 8 0 15 8 10 0.00000000015];
